{% extends 'core/base.html' %}
{% load static %}

{% block title %}Dashboard - B·∫£n ƒê·ªì C·ª©u H·ªô{% endblock %}

{% block content %}
<main class="dashboard">
    <div class="dashboard__container">
        <div class="dashboard__header">
            <div>
                <h1 class="dashboard__title">T·ªïng quan ho·∫°t ƒë·ªông</h1>
                <p class="dashboard__subtitle">Gi√°m s√°t ho·∫°t ƒë·ªông c·ª©u h·ªô th·ªùi gian th·ª±c</p>
            </div>
            <div class="dashboard__header-actions">
                <button class="dashboard__export-btn" onclick="location.reload()">üîÑ L√†m m·ªõi d·ªØ li·ªáu</button>
                <select class="dashboard__period-select">
                    <option value="day">Ng√†y</option>
                    <option value="month" selected>Th√°ng</option>
                    <option value="year">NƒÉm</option>
                </select>
            </div>
        </div>

        <div class="kpi-grid">
            <div class="kpi-card kpi-card--total">
                <div class="kpi-card__icon">üìã</div>
                <div class="kpi-card__content">
                    <span class="kpi-card__label">T·ªïng Y√™u C·∫ßu</span>
                    <span id="kpi-total" class="kpi-card__value">...</span>
                    <span id="trend-total" class="kpi-card__trend kpi-card__trend--neutral">ƒêang t·∫£i...</span>
                </div>
            </div>

            <div class="kpi-card kpi-card--open">
                <div class="kpi-card__icon">üÜò</div>
                <div class="kpi-card__content">
                    <span class="kpi-card__label">ƒêang Ch·ªù X·ª≠ L√Ω</span>
                    <span id="kpi-pending" class="kpi-card__value">...</span>
                    <span id="trend-pending" class="kpi-card__trend kpi-card__trend--neutral">ƒêang t·∫£i...</span>
                </div>
            </div>

            <div class="kpi-card kpi-card--processing">
                <div class="kpi-card__icon">‚öôÔ∏è</div>
                <div class="kpi-card__content">
                    <span class="kpi-card__label">ƒêang Th·ª±c Hi·ªán</span>
                    <span id="kpi-processing" class="kpi-card__value">...</span>
                    <span id="trend-processing" class="kpi-card__trend kpi-card__trend--neutral">ƒêang t·∫£i...</span>
                </div>
            </div>

            <div class="kpi-card kpi-card--resolved">
                <div class="kpi-card__icon">‚úÖ</div>
                <div class="kpi-card__content">
                    <span class="kpi-card__label">ƒê√£ Ho√†n Th√†nh</span>
                    <span id="kpi-resolved" class="kpi-card__value">...</span>
                    <span id="trend-resolved" class="kpi-card__trend kpi-card__trend--neutral">ƒêang t·∫£i...</span>
                </div>
            </div>
        </div>

        <div class="dashboard__grid">
            <div class="chart-card chart-card--large">
                <div class="chart-card__header">
                    <h3 class="chart-card__title">Th·ªëng k√™ s·ªë y√™u c·∫ßu theo th·ªùi gian</h3>
                </div>
                <div class="chart-card__body">
                    <div style="position: relative; height: 300px; width: 100%;">
                        <canvas id="timelineChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-card__header">
                    <h3 class="chart-card__title">Tr·∫°ng th√°i x·ª≠ l√Ω</h3>
                </div>
                <div class="chart-card__body">
                    <div style="position: relative; height: 300px; width: 100%;">
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-card__header">
                    <h3 class="chart-card__title">ƒêi·ªÉm n√≥ng theo khu v·ª±c</h3>
                    <span style="color: red;">üöß B·∫£o tr√¨ üöß</span>
                </div>
                <div class="chart-card__body">
                    <div style="position: relative; height: 250px; width: 100%;">
                        <canvas id="districtChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-card__header">
                    <h3 class="chart-card__title">M·ª©c ƒë·ªô ∆∞u ti√™n</h3>
                </div>
                <div class="chart-card__body">
                    <div style="position: relative; height: 250px; width: 100%;">
                        <canvas id="priorityChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-card__header">
                    <h3 class="chart-card__title">Y√™u c·∫ßu ƒë√£ x·ª≠ l√Ω</h3>
                </div>
                <div class="chart-card__body">
                     <div style="text-align: center; margin-bottom: 10px;">
                        <span style="font-size: 0.9rem; color: #666;">Trung b√¨nh: </span>
                        <span id="avg-response-val" style="font-weight: bold; font-size: 1.5rem; color: #2C5F8D;">--</span>
                        <span style="font-size: 0.9rem; color: #666;"> gi·ªù/y√™u c·∫ßu</span>
                    </div>
                    <div style="position: relative; height: 200px; width: 100%;">
                        <canvas id="resolvedTimeChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="chart-card chart-card--large">
                <div class="chart-card__header">
                    <h3 class="chart-card__title" style="display: flex; align-items: center; gap: 8px;">
                        T√¨nh tr·∫°ng ngu·ªìn l·ª±c
                        <img src="{% static 'analytics/images/live_stream_icon.png' %}" alt="live-data" class="button-icon" style="height: 1.5em; width: auto;">
                    </h3>
                </div>
                <div class="chart-card__body">
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Lo·∫°i Ngu·ªìn L·ª±c</th>
                                    <th>T·ªïng S·ªë</th>
                                    <th>S·∫µn S√†ng</th>
                                    <th>Hi·ªáu Su·∫•t</th>
                                </tr>
                            </thead>
                            <tbody id="resourceTableBody">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
{% endblock %}

{% block extra_js %}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{% static 'analytics/js/dashboard.js' %}"></script>
{% endblock %}