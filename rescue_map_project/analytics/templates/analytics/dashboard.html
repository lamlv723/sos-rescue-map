{% extends 'core/base.html' %}
{% load static %}

{% block title %}Dashboard - Rescue Map{% endblock %}

{% block content %}
<main class="dashboard">
    <div class="dashboard__container">
        <div class="dashboard__header">
            <div>
                <h1 class="dashboard__title">Dashboard Overview</h1>
                <p class="dashboard__subtitle">Real-time rescue operations monitoring</p>
            </div>
            <div class="dashboard__header-actions">
                <button class="dashboard__export-btn" onclick="location.reload()">üîÑ Refresh Data</button>
                <select class="dashboard__period-select">
                    <option>Last 24 Hours</option>
                    <option>Last 7 Days</option>
                    <option>Last 30 Days</option>
                    <option>Custom Range</option>
                </select>
            </div>
        </div>

        <div class="kpi-grid">
            <div class="kpi-card kpi-card--total">
                <div class="kpi-card__icon">üìã</div>
                <div class="kpi-card__content">
                    <span class="kpi-card__label">Total Requests</span>
                    <span id="kpi-total" class="kpi-card__value">...</span>
                    <span id="trend-total" class="kpi-card__trend kpi-card__trend--neutral">Loading...</span>
                </div>
            </div>

            <div class="kpi-card kpi-card--open">
                <div class="kpi-card__icon">üÜò</div>
                <div class="kpi-card__content">
                    <span class="kpi-card__label">Active Requests</span>
                    <span id="kpi-active" class="kpi-card__value">...</span>
                    <span id="trend-active" class="kpi-card__trend kpi-card__trend--neutral">Loading...</span>
                </div>
            </div>

            <div class="kpi-card kpi-card--processing">
                <div class="kpi-card__icon">‚öôÔ∏è</div>
                <div class="kpi-card__content">
                    <span class="kpi-card__label">In Progress</span>
                    <span id="kpi-processing" class="kpi-card__value">...</span>
                    <span id="trend-processing" class="kpi-card__trend kpi-card__trend--neutral">Loading...</span>
                </div>
            </div>

            <div class="kpi-card kpi-card--resolved">
                <div class="kpi-card__icon">‚úÖ</div>
                <div class="kpi-card__content">
                    <span class="kpi-card__label">Resolved Today</span>
                    <span id="kpi-resolved" class="kpi-card__value">...</span>
                    <span id="trend-resolved" class="kpi-card__trend kpi-card__trend--neutral">Loading...</span>
                </div>
            </div>
        </div>

        <div class="dashboard__grid">
            <div class="chart-card chart-card--large">
                <div class="chart-card__header">
                    <h3 class="chart-card__title">Requests Timeline</h3>
                    <div class="chart-card__controls">
                        <button class="chart-card__btn chart-card__btn--active">Hour</button>
                        <button class="chart-card__btn">Day</button>
                        <button class="chart-card__btn">Week</button>
                    </div>
                </div>
                <div class="chart-card__body">
                    <div style="height: 300px; width: 100%;">
                        <canvas id="timelineChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-card__header">
                    <h3 class="chart-card__title">Status Distribution</h3>
                </div>
                <div class="chart-card__body">
                    <div style="height: 300px; display: flex; justify-content: center;">
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="chart-card">
                <div class="chart-card__header">
                    <h3 class="chart-card__title">Priority Levels</h3>
                </div>
                <div class="chart-card__body">
                    <div style="height: 300px;">
                        <canvas id="priorityChart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="chart-card">
                <div class="chart-card__header">
                    <h3 class="chart-card__title">Geographic Hotspots</h3>
                </div>
                <div class="chart-card__body">
                    <div class="chart-placeholder">
                        [Heatmap: Requests by district - Use ArcGIS API]
                    </div>
                </div>
            </div>

            <div class="chart-card chart-card--large">
                <div class="chart-card__header">
                    <h3 class="chart-card__title">Resource Allocation</h3>
                </div>
                <div class="chart-card__body">
                    <div class="table-responsive">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Resource Type</th>
                                    <th>Total</th> <th>Available</th>
                                    <th>Utilization</th>
                                </tr>
                            </thead>
                            <tbody id="resourceTableBody">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
{% endblock %}

{% block extra_js %}
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="{% static 'analytics/js/dashboard.js' %}"></script>
{% endblock %}