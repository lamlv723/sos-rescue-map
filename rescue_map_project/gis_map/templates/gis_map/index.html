{% extends 'core/base.html' %}

{% load static %}

{% block title %}B·∫£n ƒë·ªì c·ª©u h·ªô - UT GIS Project{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="https://js.arcgis.com/4.33/esri/themes/light/main.css" />
    <link rel="stylesheet" href="{% static 'css/map.css' %}" />
{% endblock %}

{% block content %}
    <!-- Main Map Page -->
    <main class="map-page">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar__overlay" id="sidebar-overlay"></div>

            <div class="sidebar__container">

            <div class="sidebar__header">
               <div class="sidebar__logo">
                    <img
                        src="{% static 'core/images/logo.webp' %}"
                        alt="UT GIS Project"
                        class="sidebar__logo-img"
                    />
                    <span class="sidebar__logo-text">B·∫£n ƒë·ªì C·ª©u h·ªô</span>
               </div>
               <button class="sidebar__close" title="Close Sidebar" type="button" id="btn-close-sidebar">
                    <span class="sidebar__close-icon">
                        <img src="{% static 'core/images/x.svg' %}" alt="Close Sidebar" />
                    </span>
               </button>
            </div>

            <!-- Search Box -->
            <div class="sidebar__section">
                <div class="search-box__container">
                    <div>
                        <input type="radio" name="search_type" id="search-type-areas" value="areas" checked />
                        <label for="search-type-areas" class="search-box__label">Khu v·ª±c</label>
                    </div>
                    <div>
                        <input type="radio" name="search_type" id="search-type-phone" value="phone" />
                        <label for="search-type-phone" class="search-box__label">S·ªë ƒëi·ªán tho·∫°i</label>
                    </div>
                </div>

                <div class="search-box">
                    <input type="text" id="search-box-input" class="search-box__input" placeholder="T√¨m theo khu v·ª±c, ph∆∞·ªùng/qu·∫≠n‚Ä¶" />
                    <button class="search-box__btn" title="T√¨m ki·∫øm" type="button" id="btn-find">
                        <img src="{% static 'core/images/search.svg' %}" alt="T√¨m" />
                    </button>
                </div>
            </div>

            <div id="sidebar-filters__areas" class="sidebar__filters">
                <!-- Priority Filter -->
                <div class="sidebar__section">
                    <h3 class="sidebar__section-title--highlight">M·ª©c ƒë·ªô kh·∫©n c·∫•p</h3>
                    <div class="filter-group">
                        <label class="filter-group__item filter-group__item--highlight">
                            <span class="filter-group__item-content">
                                <span class="filter-group__badge filter-group__badge--critical">Nghi√™m tr·ªçng</span>
<<<<<<< HEAD
                                <span class="filter-group__count" id="filter-group__count-critical">&nbsp;</span>
=======
                                <span class="filter-group__count">(45)</span>
>>>>>>> 36b8327 (Feature/phuc b gis map (#8))
                            </span>
                            <input type="checkbox" class="filter-group__checkbox" name="priority" value="critical" />
                        </label>
                        <label class="filter-group__item">
                            <span class="filter-group__item-content">
                                <span class="filter-group__badge filter-group__badge--high">Kh·∫©n c·∫•p</span>
<<<<<<< HEAD
                                <span class="filter-group__count" id="filter-group__count-high">&nbsp;</span>
=======
                                <span class="filter-group__count">(89)</span>
>>>>>>> 36b8327 (Feature/phuc b gis map (#8))
                            </span>
                            <input type="checkbox" class="filter-group__checkbox" name="priority" value="high" />
                        </label>
                        <label class="filter-group__item">
                            <span class="filter-group__item-content">
                                <span class="filter-group__badge filter-group__badge--medium">C·∫ßn h·ªó tr·ª£</span>
<<<<<<< HEAD
                                <span class="filter-group__count" id="filter-group__count-medium">&nbsp;</span>
=======
                                <span class="filter-group__count">(76)</span>
>>>>>>> 36b8327 (Feature/phuc b gis map (#8))
                            </span>
                            <input type="checkbox" class="filter-group__checkbox" name="priority" value="medium" />
                        </label>
                    </div>
                </div>

                <!-- Status Filter -->
                <div class="sidebar__section">
                    <h3 class="sidebar__section-title">T√¨nh tr·∫°ng</h3>
                    <div class="filter-group">
<<<<<<< HEAD
                        <label class="filter-group__item" for="status-pending">
                            <span class="filter-group__item-content">
                                <span class="filter-group__badge filter-group__badge--pending">Ch∆∞a h·ªó tr·ª£</span>
                                <span class="filter-group__count" id="filter-group__count-pending">&nbsp;</span>
                            </span>
                            <input type="checkbox" class="filter-group__checkbox" id="status-pending" name="status" value="open" />
                        </label>
                        <label class="filter-group__item" for="status-assigned">
                            <span class="filter-group__item-content">
                                <span class="filter-group__badge filter-group__badge--assigned">ƒêang h·ªó tr·ª£</span>
                                <span class="filter-group__count" id="filter-group__count-assigned">&nbsp;</span>
                            </span>
                            <input type="checkbox" class="filter-group__checkbox" id="status-assigned" name="status" value="open" />
                        </label>
                        <label class="filter-group__item" for="status-resolved">
                            <span class="filter-group__item-content">
                                <span class="filter-group__badge filter-group__badge--resolved">ƒê√£ h·ªó tr·ª£</span>
                                <span class="filter-group__count" id="filter-group__count-resolved">&nbsp;</span>
                            </span>
                            <input type="checkbox" class="filter-group__checkbox" id="status-resolved" name="status" value="closed" />
=======
                        <label class="filter-group__item" for="status-open">
                            <span class="filter-group__item-content">
                                <span class="filter-group__badge filter-group__badge--open">Ch∆∞a h·ªó tr·ª£</span>
                                <span class="filter-group__count">(142)</span>
                            </span>
                            <input type="checkbox" class="filter-group__checkbox" id="status-open" name="status" value="open" />
                        </label>
                        <label class="filter-group__item" for="status-closed">
                            <span class="filter-group__item-content">
                                <span class="filter-group__badge filter-group__badge--closed">ƒê√£ h·ªó tr·ª£</span>
                                <span class="filter-group__count">(234)</span>
                            </span>
                            <input type="checkbox" class="filter-group__checkbox" id="status-closed" name="status" value="closed" />
>>>>>>> 36b8327 (Feature/phuc b gis map (#8))
                        </label>
                    </div>
                </div>

                <!-- Time Range -->
                <div class="sidebar__section">
                    <h3 class="sidebar__section-title">Th·ªùi ƒëi·ªÉm ghi nh·∫≠n g·∫ßn nh·∫•t</h3>
                    <div class="time-filter">
                        <label class="time-filter__btn">
                            <input type="radio" name="time_range" value="1">
                            <span>1 gi·ªù</span>
                        </label>
                        <label class="time-filter__btn">
                            <input type="radio" name="time_range" value="6">
                            <span>6 gi·ªù</span>
                        </label>
                        <label class="time-filter__btn">
                            <input type="radio" name="time_range" value="24" checked>
                            <span>24 gi·ªù</span>
                        </label>
                    </div>
                    <div class="time-filter__custom-container">
                        <label class="time-filter__btn time-filter__btn--custom">
                            <input type="radio" name="time_range" value="custom">
                            <img src="{% static 'core/images/calendar-range.svg' %}" class="time-filter__btn-icon" alt="Ch·ªçn kho·∫£ng th·ªùi gian" />
                            <span>Ch·ªçn kho·∫£ng th·ªùi gian c·ª• th·ªÉ</span>
                        </label>
                        <div class="time-filter__custom-inputs" id="time-filter__custom-inputs">
                            <div>
                                <label class="time-filter__custom-label" for="time-filter__custom-input-start">Th·ªùi gian b·∫Øt ƒë·∫ßu</label>
                                <input type="datetime-local" id="time-filter__custom-input-start" name="time-filter__custom-input-start" class="time-filter__custom-input"  min="1970-01-01T00:00">
                            </div>
                            <div>
                                <label class="time-filter__custom-label" for="time-filter__custom-input-end">Th·ªùi gian k·∫øt th√∫c</label>
                                <input type="datetime-local" id="time-filter__custom-input-end" name="time-filter__custom-input-end" class="time-filter__custom-input" min="1970-01-01T00:00">
                            </div>
                            <div class="time-filter__actions">
                                <button class="time-filter__btn-clear" type="button" id="btn-clear-time-filter">X√≥a</button>
                                <button class="time-filter__btn-apply" type="button" id="btn-apply-time-filter">√Åp d·ª•ng</button>
                           </div>
                       </div>
                    </div>
                </div>

                <div class="sidebar__btn-clear-all-section" id="sidebar__btn-clear-all-section">
                    <button class="sidebar__btn-clear-all" type="button" id="btn-clear-all-time-filter">X√≥a t·∫•t c·∫£ b·ªô l·ªçc</button>
                </div>

                <!-- Recent Requests List -->
                <!-- <div class="sidebar__section">
                    <h3 class="sidebar__section-title">Recent Requests</h3>
                    <div class="request-list">
                        <div class="request-card">
                            <div class="request-card__header">
                                <span class="request-card__id">#10423</span>
                                <span class="request-card__badge request-card__badge--critical">Critical</span>
                            </div>
                            <p class="request-card__message">N∆∞·ªõc d√¢ng cao, c√≥ 5 ng∆∞·ªùi b·ªã k·∫πt</p>
                            <div class="request-card__meta">
                                <span class="request-card__time">‚è± 15 min ago</span>
                                <span class="request-card__location">üìç District 8</span>
                            </div>
                            <button class="request-card__action">View on Map ‚Üí</button>
                        </div>

                        <div class="request-card">
                            <div class="request-card__header">
                                <span class="request-card__id">#10422</span>
                                <span class="request-card__badge request-card__badge--high">High</span>
                            </div>
                            <p class="request-card__message">C·∫ßn l∆∞∆°ng th·ª±c kh·∫©n c·∫•p</p>
                            <div class="request-card__meta">
                                <span class="request-card__time">‚è± 32 min ago</span>
                                <span class="request-card__location">üìç District 4</span>
                            </div>
                            <button class="request-card__action">View on Map ‚Üí</button>
                        </div>

                        <div class="request-card">
                            <div class="request-card__header">
                                <span class="request-card__id">#10421</span>
                                <span class="request-card__badge request-card__badge--medium">Medium</span>
                            </div>
                            <p class="request-card__message">C·∫ßn thu·ªëc men c∆° b·∫£n</p>
                            <div class="request-card__meta">
                                <span class="request-card__time">‚è± 1h ago</span>
                                <span class="request-card__location">üìç District 7</span>
                            </div>
                            <button class="request-card__action">View on Map ‚Üí</button>
                        </div>
                    </div>
                </div> -->
                </div>

                <div id="sidebar-filters__phone" class="sidebar__filters" style="display: none;">
                    <div class="sidebar__section">
                        <p class="sidebar__section-title">Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i ƒë·ªÉ xem nhanh v·ªã tr√≠ v√† t√¨nh tr·∫°ng y√™u c·∫ßu c·ª©u tr·ª£.</p>
                    </div>
                </div>
            </div>

       
        </aside>

        <!-- Map Container -->
        <div class="map-container" id="map-container">
            <div id="mapView" class="map-container__view">
                <!-- Map will be rendered here -->
                <!-- <div class="map-container__placeholder">
                    [ArcGIS Map View - Initialize with script.js]
                </div> -->
            </div>

            <div id="basemapStyles" class="esri-widget">
                <select id="selectBasemap" class="esri-select basemap-styles">
                    <option value="gray-vector">B·∫£n ƒë·ªì X√°m (M·∫∑c ƒë·ªãnh)</option>
                    <option value="satellite">·∫¢nh V·ªá tinh (Satellite)</option>
                    <option value="streets-vector">B·∫£n ƒë·ªì ƒê∆∞·ªùng ph·ªë</option>
                    <option value="dark-gray-vector">B·∫£n ƒë·ªì T·ªëi (Dark Mode)</option>
                    <option value="osm">OpenStreetMap</option>
                    <option value="topo-vector">ƒê·ªãa h√¨nh (Topographic)</option>
                </select>
            </div>

            <!-- Map Controls -->
            <div class="map-controls">
                <button class="esri-widget--button" title="M·ªü/ƒê√≥ng sidebar" type="button" id="btn-toggle-sidebar">
                    <span class="map-controls__icon">
                        <img src="{% static 'core/images/search.svg' %}" alt="M·ªü/ƒê√≥ng sidebar" />
                    </span>
                </button>
                <button class="esri-widget--button" title="L√†m m·ªõi d·ªØ li·ªáu" type="button" id="btn-refresh-data">
                    <span class="map-controls__icon">
                        <img src="{% static 'core/images/refresh-ccw.svg' %}" alt="L√†m m·ªõi d·ªØ li·ªáu" />
                    </span>
                </button>
                <button class="esri-widget--button" title="To√†n m√†n h√¨nh" type="button" id="btn-fullscreen">
                    <span class="map-controls__icon">
                        <img src="{% static 'core/images/fullscreen.svg' %}" alt="To√†n m√†n h√¨nh" />
                    </span>
                </button>
                <button class="esri-widget--button" title="ƒê·ªãnh v·ªã v·ªã tr√≠ hi·ªán t·∫°i" type="button" id="btn-my-location">
                    <span class="map-controls__icon">
                        <img src="{% static 'core/images/locate-fixed.svg' %}" alt="ƒê·ªãnh v·ªã v·ªã tr√≠ hi·ªán t·∫°i" />
                    </span>
                </button>
            </div>

            <!-- Statistics Bar -->
            <!-- <div class="stats-bar">
                <div class="stats-bar__item">
                    <span class="stats-bar__label">Total Requests</span>
                    <span class="stats-bar__value stats-bar__value--total">444</span>
                </div>
                <div class="stats-bar__item">
                    <span class="stats-bar__label">Open</span>
                    <span class="stats-bar__value stats-bar__value--open">142</span>
                </div>
                <div class="stats-bar__item">
                    <span class="stats-bar__label">Resolved</span>
                    <span class="stats-bar__value stats-bar__value--resolved">234</span>
                </div>
            </div> -->
        </div>
    </main>
{% endblock %}

<!-- remove footer for this page -->
{% block footer %}{% endblock %}

{% block extra_js %}
    <script src="https://js.arcgis.com/4.33"></script>
    <script src="{% static 'js/gis-data.js' %}"></script>
    <script src="{% static 'js/map.js' %}"></script>
{% endblock %}
