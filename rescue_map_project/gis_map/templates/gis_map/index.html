{% extends 'core/base.html' %}
{% load static %}

{% block title %}Map View - Rescue Map{% endblock %} 

{% block extra_css %}
    <link rel="stylesheet" href="https://js.arcgis.com/4.29/esri/themes/light/main.css" />
{% endblock %}

{% block content %}

<!-- Main Map Page -->
<main class="map-page">
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="sidebar__header">
            <button class="sidebar__close" id="btn-close-sidebar">&#10060;</button>
        </div>

        <!-- Search Box -->
        <div class="sidebar__section">
            <div class="search-box">
                <input type="text" id="search-box-input" class="search-box__input" placeholder="Find location..." />
                <button class="search-box__btn" title="Find" type="button" id="btn-find">
                    Find
                </button>
            </div>
        </div>

        <!-- Status Filter -->
        <div class="sidebar__section">
            <h3 class="sidebar__section-title">Operational Status</h3>
            <div class="filter-group">
                <label class="filter-group__item" for="status-open">
                    <span>
                        <span class="filter-group__badge filter-group__badge--open">Open</span>
                        <span class="filter-group__count">(142)</span>
                    </span>
                    <input type="checkbox" id="status-open" name="status" value="open" />
                </label>
                <label class="filter-group__item" for="status-closed">
                    <span>
                        <span class="filter-group__badge filter-group__badge--closed">Closed</span>
                        <span class="filter-group__count">(234)</span> 
                    </span>
                    <input type="checkbox" id="status-closed" name="status" value="closed" />
                </label>
            </div>
        </div>

        <!-- Priority Filter -->
        <div class="sidebar__section">
            <h3 class="sidebar__section-title">Priority Level</h3>
            <div class="filter-group">
                <label class="filter-group__item">
                    <span>
                        <span class="filter-group__badge filter-group__badge--critical">Critical</span>
                        <span class="filter-group__count">(45)</span>
                    </span>
                    <input type="checkbox" name="priority" value="critical" />
                </label>
                <label class="filter-group__item">
                    <span>
                        <span class="filter-group__badge filter-group__badge--high">High</span>
                        <span class="filter-group__count">(89)</span>
                    </span>
                    <input type="checkbox" name="priority" value="high" />
                </label>
                <label class="filter-group__item">
                    <span>
                        <span class="filter-group__badge filter-group__badge--medium">Medium</span>
                        <span class="filter-group__count">(76)</span>
                    </span>
                    <input type="checkbox" name="priority" value="medium" />
                </label>
            </div>
        </div>

        <!-- Time Range -->
        <div class="sidebar__section">
            <h3 class="sidebar__section-title">Reported Time</h3>
            <div class="time-filter">
                <button type="button" class="time-filter__btn time-filter__btn--active">Last Hour</button>
                <button type="button" class="time-filter__btn">Last 6h</button>
                <button type="button" class="time-filter__btn">Last 24h</button>
                <button type="button" class="time-filter__btn">Custom</button>
            </div>
        </div>

        <!-- Recent Requests List -->
        <!-- <div class="sidebar__section">
            <h3 class="sidebar__section-title">Recent Requests</h3>
            <div class="request-list">
                <div class="request-card">
                    <div class="request-card__header">
                        <span class="request-card__id">#10423</span>
                        <span class="request-card__badge request-card__badge--critical">Critical</span>
                    </div>
                    <p class="request-card__message">N∆∞·ªõc d√¢ng cao, c√≥ 5 ng∆∞·ªùi b·ªã k·∫πt</p>
                    <div class="request-card__meta">
                        <span class="request-card__time">‚è± 15 min ago</span>
                        <span class="request-card__location">üìç District 8</span>
                    </div>
                    <button class="request-card__action">View on Map ‚Üí</button>
                </div>

                <div class="request-card">
                    <div class="request-card__header">
                        <span class="request-card__id">#10422</span>
                        <span class="request-card__badge request-card__badge--high">High</span>
                    </div>
                    <p class="request-card__message">C·∫ßn l∆∞∆°ng th·ª±c kh·∫©n c·∫•p</p>
                    <div class="request-card__meta">
                        <span class="request-card__time">‚è± 32 min ago</span>
                        <span class="request-card__location">üìç District 4</span>
                    </div>
                    <button class="request-card__action">View on Map ‚Üí</button>
                </div>

                <div class="request-card">
                    <div class="request-card__header">
                        <span class="request-card__id">#10421</span>
                        <span class="request-card__badge request-card__badge--medium">Medium</span>
                    </div>
                    <p class="request-card__message">C·∫ßn thu·ªëc men c∆° b·∫£n</p>
                    <div class="request-card__meta">
                        <span class="request-card__time">‚è± 1h ago</span>
                        <span class="request-card__location">üìç District 7</span>
                    </div>
                    <button class="request-card__action">View on Map ‚Üí</button>
                </div>
            </div>
        </div> -->
    </aside>

    <!-- Map Container -->
    <div class="map-container" id="map-container">
        <div id="mapView" class="map-container__view">
            <!-- Map will be rendered here -->
            <!-- <div class="map-container__placeholder">
                [ArcGIS Map View - Initialize with script.js]
            </div> -->
        </div>

        <div id="basemapStyles" class="esri-widget">
            <select id="selectBasemap" class="esri-select basemap-styles">
                <option value="gray-vector">B·∫£n ƒë·ªì X√°m (M·∫∑c ƒë·ªãnh)</option>
                <option value="satellite" selected>·∫¢nh V·ªá tinh (Satellite)</option>
                <option value="streets-vector">B·∫£n ƒë·ªì ƒê∆∞·ªùng ph·ªë</option>
                <option value="dark-gray-vector">B·∫£n ƒë·ªì T·ªëi (Dark Mode)</option>
                <option value="osm">OpenStreetMap</option>
                <option value="topo-vector">ƒê·ªãa h√¨nh (Topographic)</option>
            </select>
        </div>

        <!-- Map Controls -->
        <div class="map-controls">
            <button class="esri-widget--button" title="Toggle Sidebar" type="button" id="btn-toggle-sidebar">
                <span class="map-controls__icon">
                    <img src="{% static 'core/images/menu.svg' %}" alt="Toggle Sidebar" />
                </span>
            </button>
            <button class="esri-widget--button" title="My Location" type="button" id="btn-my-location">
                <span class="map-controls__icon">
                    <img src="{% static 'core/images/locate-fixed.svg' %}" alt="My Location" />
                </span>
            </button>
            <button class="esri-widget--button" title="Refresh Data" type="button" id="btn-refresh-data">
                <span class="map-controls__icon">
                    <img src="{% static 'core/images/refresh-ccw.svg' %}" alt="Refresh Data" />
                </span>
            </button>
            <button class="esri-widget--button" title="Fullscreen" type="button" id="btn-fullscreen">
                <span class="map-controls__icon">
                    <img src="{% static 'core/images/fullscreen.svg' %}" alt="Fullscreen" />
                </span>
            </button>
        </div>

        <!-- Statistics Bar -->
        <!-- <div class="stats-bar">
            <div class="stats-bar__item">
                <span class="stats-bar__label">Total Requests</span>
                <span class="stats-bar__value stats-bar__value--total">444</span>
            </div>
            <div class="stats-bar__item">
                <span class="stats-bar__label">Open</span>
                <span class="stats-bar__value stats-bar__value--open">142</span>
            </div>
            <div class="stats-bar__item">
                <span class="stats-bar__label">Resolved</span>
                <span class="stats-bar__value stats-bar__value--resolved">234</span>
            </div>
        </div> -->
    </div>
</main>
{% endblock %}

<!-- remove footer for this page -->
{% block footer %}{% endblock %}

{% block extra_js %}
<script src="https://js.arcgis.com/4.29/"></script>
<script src="{% static 'gis_map/js/gis-data.js' %}"></script>
<script src="{% static 'gis_map/js/map.js' %}"></script>
{% endblock %}
